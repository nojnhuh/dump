package main

import (
	"strings"
	"testing"
)

func TestMain(t *testing.T) {
	cases := []struct {
		name, in, want string
	}{
		{`lorem`, `<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Qui potest igitur habitare in beata vita summi mali metus? Praeclare Laelius, et recte sofñw, illudque vere: O Publi, o gurges, Galloni! es homo miser, inquit. Nam si propter voluptatem, quae est ista laus, quae possit e macello peti? Quae diligentissime contra Aristonem dicuntur a Chryippo. In quibus doctissimi illi veteres inesse quiddam caeleste et divinum putaverunt. Bork Quaeque de virtutibus dicta sunt, quem ad modum eae semper voluptatibus inhaererent, eadem de amicitia dicenda sunt. Summus dolor plures dies manere non potest? </p>

<p>Duo Reges: constructio interrete. Quid ergo aliud intellegetur nisi uti ne quae pars naturae neglegatur? At Zeno eum non beatum modo, sed etiam divitem dicere ausus est. Si longus, levis; Polemoni et iam ante Aristoteli ea prima visa sunt, quae paulo ante dixi. Hoc est non modo cor non habere, sed ne palatum quidem. Quid, si etiam iucunda memoria est praeteritorum malorum? </p>

<p>Id enim volumus, id contendimus, ut officii fructus sit ipsum officium. Quo modo? Expressa vero in iis aetatibus, quae iam confirmatae sunt. Quodsi vultum tibi, si incessum fingeres, quo gravior viderere, non esses tui similis; Esse enim, nisi eris, non potes. </p>`,
			`[{"Word":"non","Count":6},{"Word":"quae","Count":5},{"Word":"si","Count":3},{"Word":"et","Count":3},{"Word":"est","Count":3},{"Word":"\u003c/p\u003e","Count":3},{"Word":"sunt.","Count":2},{"Word":"sunt,","Count":2},{"Word":"sit","Count":2},{"Word":"sed","Count":2},{"Word":"nisi","Count":2},{"Word":"ne","Count":2},{"Word":"ipsum","Count":2},{"Word":"in","Count":2},{"Word":"iam","Count":2},{"Word":"etiam","Count":2},{"Word":"dolor","Count":2},{"Word":"de","Count":2},{"Word":"ante","Count":2},{"Word":"vultum","Count":1},{"Word":"voluptatibus","Count":1},{"Word":"voluptatem,","Count":1},{"Word":"volumus,","Count":1},{"Word":"vita","Count":1},{"Word":"visa","Count":1},{"Word":"virtutibus","Count":1},{"Word":"viderere,","Count":1},{"Word":"veteres","Count":1},{"Word":"vero","Count":1},{"Word":"vere:","Count":1},{"Word":"uti","Count":1},{"Word":"ut","Count":1},{"Word":"tui","Count":1},{"Word":"tibi,","Count":1},{"Word":"summi","Count":1},{"Word":"sofñw,","Count":1},{"Word":"similis;","Count":1},{"Word":"semper","Count":1},{"Word":"recte","Count":1},{"Word":"quo","Count":1},{"Word":"quidem.","Count":1},{"Word":"quiddam","Count":1},{"Word":"quibus","Count":1},{"Word":"quem","Count":1},{"Word":"putaverunt.","Count":1},{"Word":"propter","Count":1},{"Word":"prima","Count":1},{"Word":"praeteritorum","Count":1},{"Word":"potest?","Count":1},{"Word":"potest","Count":1},{"Word":"potes.","Count":1},{"Word":"possit","Count":1},{"Word":"plures","Count":1},{"Word":"peti?","Count":1},{"Word":"paulo","Count":1},{"Word":"pars","Count":1},{"Word":"palatum","Count":1},{"Word":"officium.","Count":1},{"Word":"officii","Count":1},{"Word":"o","Count":1},{"Word":"neglegatur?","Count":1},{"Word":"naturae","Count":1},{"Word":"modum","Count":1},{"Word":"modo?","Count":1},{"Word":"modo,","Count":1},{"Word":"modo","Count":1},{"Word":"miser,","Count":1},{"Word":"metus?","Count":1},{"Word":"memoria","Count":1},{"Word":"manere","Count":1},{"Word":"malorum?","Count":1},{"Word":"mali","Count":1},{"Word":"macello","Count":1},{"Word":"longus,","Count":1},{"Word":"levis;","Count":1},{"Word":"laus,","Count":1},{"Word":"iucunda","Count":1},{"Word":"ista","Count":1},{"Word":"interrete.","Count":1},{"Word":"intellegetur","Count":1},{"Word":"inquit.","Count":1},{"Word":"inhaererent,","Count":1},{"Word":"inesse","Count":1},{"Word":"incessum","Count":1},{"Word":"illudque","Count":1},{"Word":"illi","Count":1},{"Word":"iis","Count":1},{"Word":"igitur","Count":1},{"Word":"id","Count":1},{"Word":"homo","Count":1},{"Word":"habitare","Count":1},{"Word":"habere,","Count":1},{"Word":"gurges,","Count":1},{"Word":"gravior","Count":1},{"Word":"fructus","Count":1},{"Word":"fingeres,","Count":1},{"Word":"eum","Count":1},{"Word":"est.","Count":1},{"Word":"esses","Count":1},{"Word":"es","Count":1},{"Word":"eris,","Count":1},{"Word":"ergo","Count":1},{"Word":"enim,","Count":1},{"Word":"enim","Count":1},{"Word":"elit.","Count":1},{"Word":"eae","Count":1},{"Word":"eadem","Count":1},{"Word":"ea","Count":1},{"Word":"e","Count":1},{"Word":"doctissimi","Count":1},{"Word":"dixi.","Count":1},{"Word":"divitem","Count":1},{"Word":"divinum","Count":1},{"Word":"diligentissime","Count":1},{"Word":"dies","Count":1},{"Word":"dicuntur","Count":1},{"Word":"dicta","Count":1},{"Word":"dicere","Count":1},{"Word":"dicenda","Count":1},{"Word":"cor","Count":1},{"Word":"contra","Count":1},{"Word":"contendimus,","Count":1},{"Word":"constructio","Count":1},{"Word":"consectetur","Count":1},{"Word":"confirmatae","Count":1},{"Word":"caeleste","Count":1},{"Word":"beatum","Count":1},{"Word":"beata","Count":1},{"Word":"ausus","Count":1},{"Word":"amicitia","Count":1},{"Word":"amet,","Count":1},{"Word":"aliud","Count":1},{"Word":"aetatibus,","Count":1},{"Word":"adipiscing","Count":1},{"Word":"ad","Count":1},{"Word":"a","Count":1},{"Word":"Zeno","Count":1},{"Word":"Summus","Count":1},{"Word":"Si","Count":1},{"Word":"Reges:","Count":1},{"Word":"Quodsi","Count":1},{"Word":"Quo","Count":1},{"Word":"Quid,","Count":1},{"Word":"Quid","Count":1},{"Word":"Qui","Count":1},{"Word":"Quaeque","Count":1},{"Word":"Quae","Count":1},{"Word":"Publi,","Count":1},{"Word":"Praeclare","Count":1},{"Word":"Polemoni","Count":1},{"Word":"O","Count":1},{"Word":"Nam","Count":1},{"Word":"Laelius,","Count":1},{"Word":"In","Count":1},{"Word":"Hoc","Count":1},{"Word":"Galloni!","Count":1},{"Word":"Expressa","Count":1},{"Word":"Esse","Count":1},{"Word":"Chryippo.","Count":1},{"Word":"Bork","Count":1},{"Word":"At","Count":1},{"Word":"Aristoteli","Count":1},{"Word":"Aristonem","Count":1},{"Word":"\u003cp\u003eLorem","Count":1},{"Word":"\u003cp\u003eId","Count":1},{"Word":"\u003cp\u003eDuo","Count":1}]`,
		},

		{`For your cold`, `Rock Soup`, `[{"Word":"Soup","Count":1},{"Word":"Rock","Count":1}]`},
	}

	for _, c := range cases {
		t.Run(c.name, func(t *testing.T) {
			got := word_json(strings.NewReader(c.in))
			if got != c.want {
				t.Errorf("word_json(%q) == %q, want %q", c.in, got, c.want)
			}
		})
	}
}
